
C  <X(PHI1)-R-EXACT-{1<=PHI1, PHI1<=N}>
C  <X(PHI1)-W-EXACT-{1<=PHI1, PHI1<=N}>
C  <Y(PHI1)-R-EXACT-{1<=PHI1, PHI1<=N}>

C     
C     COMPUTATION OF X = X + S*Y
C     
C     SUMMARY OF EFFECTS ON A PROCEDURE
C     
      SUBROUTINE SAXPY(N, X, Y, S)
C     
      INTEGER N
      REAL*8 X(N), Y(N), S
C     
      M = MOD(N, 4)                                                     0001

C  <X(PHI1)-R-EXACT-{1<=PHI1, PHI1<=M, PHI1<=N, M<=3}>
C  <X(PHI1)-W-EXACT-{1<=PHI1, PHI1<=M, PHI1<=N, M<=3}>
C  <Y(PHI1)-R-EXACT-{1<=PHI1, PHI1<=M, PHI1<=N, M<=3}>

      DO I = 1, M                                                       0002

C  <X(PHI1)-R-EXACT-{PHI1==I, PHI1<=N, 1<=I, I<=M, M<=3}>
C  <X(PHI1)-W-EXACT-{PHI1==I, PHI1<=N, 1<=I, I<=M, M<=3}>
C  <Y(PHI1)-R-EXACT-{PHI1==I, PHI1<=N, 1<=I, I<=M, M<=3}>

         X(I) = X(I)+S*Y(I)                                             0003
      ENDDO

C  <X(PHI1)-R-EXACT-{1+M<=PHI1, PHI1<=N, 0<=M, M<=3}>
C  <X(PHI1)-W-EXACT-{1+M<=PHI1, PHI1<=N, 0<=M, M<=3}>
C  <Y(PHI1)-R-EXACT-{1+M<=PHI1, PHI1<=N, 0<=M, M<=3}>

C     
      DO I = M+1, N, 4                                                  0004

C  <X(PHI1)-R-EXACT-{PHI1==I, 1+M<=I, I<=N, 0<=M, M<=3}>
C  <X(PHI1)-W-EXACT-{PHI1==I, 1+M<=I, I<=N, 0<=M, M<=3}>
C  <Y(PHI1)-R-EXACT-{PHI1==I, 1+M<=I, I<=N, 0<=M, M<=3}>

         X(I) = X(I)+S*Y(I)                                             0005

C  <X(PHI1)-R-EXACT-{PHI1==I+1, PHI1<=N, 1+M<=I, 0<=M, M<=3}>
C  <X(PHI1)-W-EXACT-{PHI1==I+1, PHI1<=N, 1+M<=I, 0<=M, M<=3}>
C  <Y(PHI1)-R-EXACT-{PHI1==I+1, PHI1<=N, 1+M<=I, 0<=M, M<=3}>

         X(I+1) = X(I+1)+S*Y(I+1)                                       0006

C  <X(PHI1)-R-EXACT-{PHI1==I+2, PHI1<=N, 1+M<=I, 0<=M, M<=3}>
C  <X(PHI1)-W-EXACT-{PHI1==I+2, PHI1<=N, 1+M<=I, 0<=M, M<=3}>
C  <Y(PHI1)-R-EXACT-{PHI1==I+2, PHI1<=N, 1+M<=I, 0<=M, M<=3}>

         X(I+2) = X(I+2)+S*Y(I+2)                                       0007

C  <X(PHI1)-R-EXACT-{PHI1==I+3, PHI1<=N, 1+M<=I, 0<=M, M<=3}>
C  <X(PHI1)-W-EXACT-{PHI1==I+3, PHI1<=N, 1+M<=I, 0<=M, M<=3}>
C  <Y(PHI1)-R-EXACT-{PHI1==I+3, PHI1<=N, 1+M<=I, 0<=M, M<=3}>

         X(I+3) = X(I+3)+S*Y(I+3)                                       0008
      ENDDO
C
      END

C  <A(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N}>
C  <B(PHI1,PHI2)-R-EXACT-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N}>
C  <C(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N}>
C  <C(PHI1,PHI2)-W-EXACT-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N}>

C     
C     MATRIX MULTIPLICATION - VERSION WITH CALL TO SAXPY
C     
C     DATA FLOW INTERPROCEDURAL ANALYSIS
C     SUMMARY OF EFFECTS ON A PROCEDURE
C     PARALLELIZATION OF LOOPS INCLUDING CALLS TO PROCEDURE
C     
      SUBROUTINE MM03(N, A, B, C)
C     
      REAL*8 A(N,N), B(N,N), C(N,N), XAUX(0:127)

C  <C(PHI1,PHI2)-W-EXACT-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N}>

C     
      DO I = 1, N                                                       0001

C  <C(PHI1,PHI2)-W-EXACT-{PHI1==I, 1<=PHI2, PHI2<=N, 1<=I, I<=N}>

         DO J = 1, N                                                    0002

C  <C(PHI1,PHI2)-W-EXACT-{PHI1==I, PHI2==J, 1<=I, I<=N, 1<=J, J<=N}>

            C(I,J) = 0.0                                                0003
         ENDDO
      ENDDO

C  <A(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I}>
C  <B(PHI1,PHI2)-R-EXACT-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=I}>
C  <C(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I}>
C  <C(PHI1,PHI2)-W-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I}>

C     
      DO J = 1, N                                                       0004

C  <A(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=J, J<=N}>
C  <B(PHI1,PHI2)-R-EXACT-{PHI2==J, 1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N,
C    1+N<=I, 1<=I}>
C  <C(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=J, J<=N}>
C  <C(PHI1,PHI2)-W-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=J, J<=N}>

         DO K = 1, N                                                    0005

C  <A(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=J, J<=N, 1<=K, K<=N}>
C  <B(PHI1,PHI2)-R-EXACT-{PHI1==K, PHI2==J, 1<=PHI1, PHI1<=N, 1<=PHI2,
C    PHI2<=N, 1+N<=I, 1<=I}>
C  <C(PHI1,PHI2)-R-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=J, J<=N, 1<=K, K<=N}>
C  <C(PHI1,PHI2)-W-MAY-{1<=PHI1, PHI1<=N, 1<=PHI2, PHI2<=N, 1+N<=I,
C    1<=J, J<=N, 1<=K, K<=N}>

            CALL SAXPY(N, C(1,J), A(1,K), B(K,J))                       0006
         ENDDO
      ENDDO
C
      END
